"use strict";!function(a){function n(a){if(a.status>=200&&a.status<300)return a;var n=new Error(a.statusText);throw n.response=a,new Error(n)}function e(){return fetch("./api/v1/token",{credentials:"same-origin"}).then(n).then(function(a){return a.text()})}function i(a){var e=Object.keys(a),i=e.map(function(n){return n+"="+a[n]});return fetch("./api/v1/venues?"+i.join("&")).then(n).then(function(a){return a.json()})}function r(a){return'\n      <div class="small-12 medium-6 large-4 columns">\n        <div class="container">\n          <div class="title">\n            <div class="name">\n              <h5>'+a.cd_pdv+'</h5>\n            </div>\n            <div class="name">\n              <h5>'+a.ds_pdv+'</h5>\n            </div>\n          </div>\n          <hr />\n          <div class="stats-container">\n            <div class="stats">\n              <h5>'+(a.twitter_statuses||"-")+'</h5>\n              <p>\n                <span class="fa fa-twitter"></span>\n              </p>\n            </div>\n            <div class="stats">\n              <h5>'+(a.foursquare_usercount||"-")+'</h5>\n              <p>\n                <span class="fa fa-foursquare"></span>\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>'}function t(a,n){var e=Math.ceil(a/99),i='\n      <li class="pagination-previous '+(1===n?"disabled":"")+'">\n        '+(1===n?'Previous <span class="show-for-sr">page</span>':'<a href="#" aria-label="Previous page">Previous <span class="show-for-sr">page</span></a>')+"\n      </li>",r='\n      <li class="pagination-next '+(n===e?"disabled":"")+'">\n        '+(n===e?'Next <span class="show-for-sr">page</span>':'<a href="#" aria-label="Next page">Next <span class="show-for-sr">page</span></a>')+"\n      </li>",t="";if(8>=e)for(var s=1;e>=s;s++)t+=s===n?'<li class="current"><span class="show-for-sr">You\'re on page</span> '+s+"</li>":'<li><a href="#" aria-label="Page '+s+'">'+s+"</a></li>";else if(4>n){for(var l=1;4>l;l++)t+=l===n?'<li class="current"><span class="show-for-sr">You\'re on page</span> '+l+"</li>":'<li><a href="#" aria-label="Page '+l+'">'+l+"</a></li>";3===n&&(t+='<li><a href="#" aria-label="Page 4">4</a></li>'),t+='<li class="ellipsis" aria-hidden="true"></li>',t+='<li><a href="#" aria-label="Page '+e+'">'+e+"</a></li>"}else if(n>e-3){t+='<li><a href="#" aria-label="Page 1">1</a></li>',t+='<li class="ellipsis" aria-hidden="true"></li>',n===e-2&&(t+='<li><a href="#" aria-label="Page '+(e-3)+'">'+(e-3)+"</a></li>");for(var o=e-2;e>=o;o++)t+=o===n?'<li class="current"><span class="show-for-sr">You\'re on page</span> '+o+"</li>":'<li><a href="#" aria-label="Page '+o+'">'+o+"</a></li>"}else{t+='<li><a href="#" aria-label="Page 1">1</a></li>',t+='<li class="ellipsis" aria-hidden="true"></li>';for(var c=n-1;n+1>=c;c++)t+=c===n?'<li class="current"><span class="show-for-sr">You\'re on page</span> '+c+"</li>":'<li><a href="#" aria-label="Page '+c+'">'+c+"</a></li>";t+='<li class="ellipsis" aria-hidden="true"></li>',t+='<li><a href="#" aria-label="Page '+e+'">'+e+"</a></li>"}return'\n      <ul class="pagination text-center" role="navigation" aria-label="Pagination">\n        '+i+"\n        "+t+"\n        "+r+"\n      </ul>"}a(document).foundation(),a(".loading").toggle();var s=e(),l=1,o=[],c=[];s.then(function(a){return i({token:a,limit:99})}).then(function(n){o=n,c=o,l=1,a(".venues").html(c.slice(0,99).map(r).join("\n")),a(".pagination-container").html(t(o.length,l)),a(".loading").toggle()})["catch"](function(n){return a(".loading").toggle()}),a(".filters").on("click",".submit",function(n){n.preventDefault();var e=a(".search").find('input[type="text"]').val().trim();a(n.currentTarget).prop("disabled",!0),e&&(a(".loading").toggle(),s.then(function(a){return i({query:e,token:a})}).then(function(e){o=e,c=o,l=1,a(".venues").html(c.map(r).join("\n")),a(".pagination-container").html(t(o.length,l)),a(n.currentTarget).prop("disabled",!1),a(".loading").toggle()})["catch"](function(n){return a(".loading").toggle()}))}),a(".search").on("input","input",function(n){n.preventDefault();var e=a(n.currentTarget).val().trim().toLowerCase();c=o.filter(function(a){return a.ds_pdv.toLowerCase().includes(e)}),l=1,a(".venues").html(c.slice(0,99).map(r).join("\n")),a(".pagination-container").html(t(o.length,l))}),a(".pagination-container").on("click","a",function(n){n.preventDefault();var e=a(n.currentTarget).text();"Previous page"===e?l-=1:"Next page"===e?l+=1:l=parseInt(e,10),a(".venues").html(c.slice(99*l,99*l+99).map(r).join("\n")),a(".pagination-container").html(t(c.length,l)),window.scrollTo(0,0)})}($);